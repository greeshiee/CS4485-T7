"{\"data\": [\"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\", \"\\u001b[0;31mValueError\\u001b[0m                                Traceback (most recent call last)\", \"Cell \\u001b[0;32mIn[12], line 20\\u001b[0m\\n\\u001b[1;32m     15\\u001b[0m KAFKA_TOPIC \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mteam6_topic\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m     17\\u001b[0m \\u001b[38;5;66;03m# Prometheus Metrics\\u001b[39;00m\\n\\u001b[1;32m     18\\u001b[0m \\u001b[38;5;66;03m# Create Prometheus Gauges to track Kafka message data\\u001b[39;00m\\n\\u001b[1;32m     19\\u001b[0m \\u001b[38;5;66;03m# You can customize these based on your specific message structure\\u001b[39;00m\\n\\u001b[0;32m---> 20\\u001b[0m message_count \\u001b[38;5;241m=\\u001b[39m \\u001b[43mGauge\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[38;5;124;43m'\\u001b[39;49m\\u001b[38;5;124;43mkafka_messages_total\\u001b[39;49m\\u001b[38;5;124;43m'\\u001b[39;49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;124;43m'\\u001b[39;49m\\u001b[38;5;124;43mTotal number of Kafka messages processed\\u001b[39;49m\\u001b[38;5;124;43m'\\u001b[39;49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     21\\u001b[0m message_payload \\u001b[38;5;241m=\\u001b[39m Gauge(\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mkafka_message_payload\\u001b[39m\\u001b[38;5;124m'\\u001b[39m, \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mKafka message payload\\u001b[39m\\u001b[38;5;124m'\\u001b[39m, \\n\\u001b[1;32m     22\\u001b[0m                         [\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mtopic\\u001b[39m\\u001b[38;5;124m'\\u001b[39m, \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mkey\\u001b[39m\\u001b[38;5;124m'\\u001b[39m, \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mattribute\\u001b[39m\\u001b[38;5;124m'\\u001b[39m])\\n\\u001b[1;32m     24\\u001b[0m \\u001b[38;5;28;01mclass\\u001b[39;00m \\u001b[38;5;21;01mKafkaPrometheusExporter\\u001b[39;00m:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/prometheus_client/metrics.py:399\\u001b[0m, in \\u001b[0;36mGauge.__init__\\u001b[0;33m(self, name, documentation, labelnames, namespace, subsystem, unit, registry, _labelvalues, multiprocess_mode)\\u001b[0m\\n\\u001b[1;32m    397\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m multiprocess_mode \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;129;01min\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_MULTIPROC_MODES:\\n\\u001b[1;32m    398\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mValueError\\u001b[39;00m(\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mInvalid multiprocess mode: \\u001b[39m\\u001b[38;5;124m'\\u001b[39m \\u001b[38;5;241m+\\u001b[39m multiprocess_mode)\\n\\u001b[0;32m--> 399\\u001b[0m \\u001b[38;5;28;43msuper\\u001b[39;49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[38;5;21;43m__init__\\u001b[39;49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    400\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mname\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mname\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    401\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdocumentation\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdocumentation\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    402\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlabelnames\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlabelnames\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    403\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mnamespace\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mnamespace\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    404\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43msubsystem\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43msubsystem\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    405\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43munit\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43munit\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    406\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mregistry\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mregistry\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    407\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m_labelvalues\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43m_labelvalues\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    408\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    409\\u001b[0m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_kwargs[\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mmultiprocess_mode\\u001b[39m\\u001b[38;5;124m'\\u001b[39m] \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_multiprocess_mode\\n\\u001b[1;32m    410\\u001b[0m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_is_most_recent \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_multiprocess_mode \\u001b[38;5;129;01min\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_MOST_RECENT_MODES\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/prometheus_client/metrics.py:156\\u001b[0m, in \\u001b[0;36mMetricWrapperBase.__init__\\u001b[0;33m(self, name, documentation, labelnames, namespace, subsystem, unit, registry, _labelvalues)\\u001b[0m\\n\\u001b[1;32m    153\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_labelvalues:\\n\\u001b[1;32m    154\\u001b[0m     \\u001b[38;5;66;03m# Register the multi-wrapper parent metric, or if a label-less metric, the whole shebang.\\u001b[39;00m\\n\\u001b[1;32m    155\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m registry:\\n\\u001b[0;32m--> 156\\u001b[0m         \\u001b[43mregistry\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mregister\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[43m)\\u001b[49m\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/prometheus_client/registry.py:43\\u001b[0m, in \\u001b[0;36mCollectorRegistry.register\\u001b[0;33m(self, collector)\\u001b[0m\\n\\u001b[1;32m     41\\u001b[0m duplicates \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mset\\u001b[39m(\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_names_to_collectors)\\u001b[38;5;241m.\\u001b[39mintersection(names)\\n\\u001b[1;32m     42\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m duplicates:\\n\\u001b[0;32m---> 43\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mValueError\\u001b[39;00m(\\n\\u001b[1;32m     44\\u001b[0m         \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mDuplicated timeseries in CollectorRegistry: \\u001b[39m\\u001b[38;5;132;01m{}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;241m.\\u001b[39mformat(\\n\\u001b[1;32m     45\\u001b[0m             duplicates))\\n\\u001b[1;32m     46\\u001b[0m \\u001b[38;5;28;01mfor\\u001b[39;00m name \\u001b[38;5;129;01min\\u001b[39;00m names:\\n\\u001b[1;32m     47\\u001b[0m     \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_names_to_collectors[name] \\u001b[38;5;241m=\\u001b[39m collector\\n\", \"\\u001b[0;31mValueError\\u001b[0m: Duplicated timeseries in CollectorRegistry: {'kafka_messages_total'}\"], \"error\": [\"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\", \"\\u001b[0;31mValueError\\u001b[0m                                Traceback (most recent call last)\", \"Cell \\u001b[0;32mIn[12], line 20\\u001b[0m\\n\\u001b[1;32m     15\\u001b[0m KAFKA_TOPIC \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mteam6_topic\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m     17\\u001b[0m \\u001b[38;5;66;03m# Prometheus Metrics\\u001b[39;00m\\n\\u001b[1;32m     18\\u001b[0m \\u001b[38;5;66;03m# Create Prometheus Gauges to track Kafka message data\\u001b[39;00m\\n\\u001b[1;32m     19\\u001b[0m \\u001b[38;5;66;03m# You can customize these based on your specific message structure\\u001b[39;00m\\n\\u001b[0;32m---> 20\\u001b[0m message_count \\u001b[38;5;241m=\\u001b[39m \\u001b[43mGauge\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[38;5;124;43m'\\u001b[39;49m\\u001b[38;5;124;43mkafka_messages_total\\u001b[39;49m\\u001b[38;5;124;43m'\\u001b[39;49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;124;43m'\\u001b[39;49m\\u001b[38;5;124;43mTotal number of Kafka messages processed\\u001b[39;49m\\u001b[38;5;124;43m'\\u001b[39;49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     21\\u001b[0m message_payload \\u001b[38;5;241m=\\u001b[39m Gauge(\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mkafka_message_payload\\u001b[39m\\u001b[38;5;124m'\\u001b[39m, \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mKafka message payload\\u001b[39m\\u001b[38;5;124m'\\u001b[39m, \\n\\u001b[1;32m     22\\u001b[0m                         [\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mtopic\\u001b[39m\\u001b[38;5;124m'\\u001b[39m, \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mkey\\u001b[39m\\u001b[38;5;124m'\\u001b[39m, \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mattribute\\u001b[39m\\u001b[38;5;124m'\\u001b[39m])\\n\\u001b[1;32m     24\\u001b[0m \\u001b[38;5;28;01mclass\\u001b[39;00m \\u001b[38;5;21;01mKafkaPrometheusExporter\\u001b[39;00m:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/prometheus_client/metrics.py:399\\u001b[0m, in \\u001b[0;36mGauge.__init__\\u001b[0;34m(self, name, documentation, labelnames, namespace, subsystem, unit, registry, _labelvalues, multiprocess_mode)\\u001b[0m\\n\\u001b[1;32m    397\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m multiprocess_mode \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;129;01min\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_MULTIPROC_MODES:\\n\\u001b[1;32m    398\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mValueError\\u001b[39;00m(\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mInvalid multiprocess mode: \\u001b[39m\\u001b[38;5;124m'\\u001b[39m \\u001b[38;5;241m+\\u001b[39m multiprocess_mode)\\n\\u001b[0;32m--> 399\\u001b[0m \\u001b[38;5;28;43msuper\\u001b[39;49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[38;5;21;43m__init__\\u001b[39;49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    400\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mname\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mname\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    401\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdocumentation\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdocumentation\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    402\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlabelnames\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlabelnames\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    403\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mnamespace\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mnamespace\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    404\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43msubsystem\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43msubsystem\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    405\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43munit\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43munit\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    406\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mregistry\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mregistry\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    407\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m_labelvalues\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43m_labelvalues\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    408\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    409\\u001b[0m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_kwargs[\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mmultiprocess_mode\\u001b[39m\\u001b[38;5;124m'\\u001b[39m] \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_multiprocess_mode\\n\\u001b[1;32m    410\\u001b[0m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_is_most_recent \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_multiprocess_mode \\u001b[38;5;129;01min\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_MOST_RECENT_MODES\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/prometheus_client/metrics.py:156\\u001b[0m, in \\u001b[0;36mMetricWrapperBase.__init__\\u001b[0;34m(self, name, documentation, labelnames, namespace, subsystem, unit, registry, _labelvalues)\\u001b[0m\\n\\u001b[1;32m    153\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_labelvalues:\\n\\u001b[1;32m    154\\u001b[0m     \\u001b[38;5;66;03m# Register the multi-wrapper parent metric, or if a label-less metric, the whole shebang.\\u001b[39;00m\\n\\u001b[1;32m    155\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m registry:\\n\\u001b[0;32m--> 156\\u001b[0m         \\u001b[43mregistry\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mregister\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[43m)\\u001b[49m\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/prometheus_client/registry.py:43\\u001b[0m, in \\u001b[0;36mCollectorRegistry.register\\u001b[0;34m(self, collector)\\u001b[0m\\n\\u001b[1;32m     41\\u001b[0m duplicates \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mset\\u001b[39m(\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_names_to_collectors)\\u001b[38;5;241m.\\u001b[39mintersection(names)\\n\\u001b[1;32m     42\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m duplicates:\\n\\u001b[0;32m---> 43\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mValueError\\u001b[39;00m(\\n\\u001b[1;32m     44\\u001b[0m         \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mDuplicated timeseries in CollectorRegistry: \\u001b[39m\\u001b[38;5;132;01m{}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;241m.\\u001b[39mformat(\\n\\u001b[1;32m     45\\u001b[0m             duplicates))\\n\\u001b[1;32m     46\\u001b[0m \\u001b[38;5;28;01mfor\\u001b[39;00m name \\u001b[38;5;129;01min\\u001b[39;00m names:\\n\\u001b[1;32m     47\\u001b[0m     \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_names_to_collectors[name] \\u001b[38;5;241m=\\u001b[39m collector\\n\", \"\\u001b[0;31mValueError\\u001b[0m: Duplicated timeseries in CollectorRegistry: {'kafka_messages_total'}\"], \"execution_state\": null, \"metadata\": null, \"msg_id\": \"29924d06-05661f4c1e87b1e0d3c7aa2f_13_11\", \"msg_type\": \"error\", \"type\": \"text\", \"block_type\": \"scratchpad\", \"pipeline_uuid\": null, \"uuid\": \"loader\"}"